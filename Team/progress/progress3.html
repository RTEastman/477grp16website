<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
This is an example weekly progress report document that team members can use to report their individual progress 
of their ECE477 senior design projects. Weekly progress reports are expected to follow the general guidelines
presented in the "Progress Report Policy" document, available online at https://engineering.purdue.edu/ece477/Course/Policies/policies.html

Please create 4 copies of this example, renaming each copy to <PurdueID>.html, where <PurdueID> corresponds to
the Purdue ITAP Career Account ID given by Purdue to each individual team member. If you have any questions,
contact course staff.
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<!--Reconfigurable base tag; used to modify the site root location for root-relative links-->
<base href="https://engineering.purdue.edu/477grp16/" />


<!--Content-->
<title>ECE477 Course Documents</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta name="author" content="George Hadley">
<meta name = "format-detection" content = "telephone=no" />
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<!--CSS-->
<link rel="stylesheet" href="css/default.css" type="text/css" media="all" />
<link rel="stylesheet" href="css/responsive.css">
<link rel="stylesheet" href="css/styles.css">
<link rel="stylesheet" href="css/content.css">
<!--[if IE 6]>
<link href="default_ie6.css" rel="stylesheet" type="text/css" />
<![endif]-->

</head>
<body>
<div id="wrapper_site">
    <div id="wrapper_page">
	<!-- Instantiate global site header.-->
	<div id="header"></div>
		<!-- Instantiate site global navigation bar.-->
		<div id="menu">
			<div class="container">
			<div class="navbar navbar_ clearfix">
				<div class="navbar-inner">      
				<div class="clearfix">
					<div class="nav-collapse nav-collapse_ collapse">
					<ul class="nav sf-menu clearfix sf-js-enabled">
						<li class="active"><a href="index.html">Home</a></li> 
						<li><a href="Team/team.html">Team</a></li>
						<li class="sub-menu"><a href="Files/documents.html" class="sf-with-ul">Documents<b class="sf-sub-indicator"></b></a>
							<ul class="submenu" style="display: none;">
								<li><a href="Files/documents.html">Documents</a></li>
								<li><a href="Files/references.html">References</a></li>
							</ul>
						</li> 
						<li><a href="https://github.com">Source</a></li>
						<li><a href="Media/media.html">Media</a></li>
						<li class="sub-menu"><a href="Contact/contact.html" class="sf-with-ul">Contact<b class="sf-sub-indicator"></b></a>
							<ul class="submenu" style="display: none;">
								<li><a href="mailto:cao216@purdue.edu?subject=[ECE477]">Jason Cao</a></li>
								<li><a href="mailto:wang4166@purdue.edu?subject=[ECE477]">Zicong Wang</a></li>
								<li><a href="mailto:jshader@purdue.edu?subject=[ECE477]">Jonah Shader</a></li>
								<li><a href="mailto:reastman@purdue.edu?subject=[ECE477]">Ryan Eastman</a></li>                      
							</ul>
						</li>
						<li class="last"><a href="https://engineering.purdue.edu/ece477">ECE477</a></li>
					</ul>
					</div>                                                                                                                
				</div>
				</div>  
			</div>
			</div>
		</div>
	
		<!-- Instantiate a page banner image. Page banner images should be 1100x350px and should be located within the local
			img folder located at this directory level. -->
		<div id="banner">
			<img src="Files/img/BannerImgExample.jpg"></img>
		</div>
	
		<!-- Instantiate "tools" needed for a page. Tools are premade functional blocks that can be used to build a page,
			and include things such as a file lister (for listing out homework assignments or tutorials)
		-->
		<div id="content">
            <h2>Progress Report for Jonah Shader</h2>
			<h4>Week 1:</h4>
			<b>Date:</b> 1/29/2021<br>
			<b>Total hours:</b> 5<br>
			<b>Description of design efforts:</b>
			I discussed changes that would need to happen hardware wise in order to have a functioning conveyer belt. Specifically, I informed the team that servo motors should be used for the sorting flaps instead of brushed DC motors. I also did research into the circuits needed to drive the motors.
			<br>
			<h4>Week 2:</h4>
			<b>Date:</b> 1/29/21<br>
			<b>Total hours:</b> 7<br>
			<b>Description of design efforts:</b>
			We redid the PSSC’s in the Final Project Proposal (FPP) to better describe how certain criteria would be accomplished. I specifically rewrote PSSC #2: “An ability to control all servo positions using level-shifted pwms of variable duty cycle originating from the mcu.” I also edited my background in the FPP to be more clear about my past experience. I also worked on the functional spec document.
            <br>
			<h4>Week 3:</h4>
			<b>Date:</b> 2/5/21<br>
			<b>Total hours:</b> 12<br>
			<b>Description of design efforts:</b>
			 I spent a long time at the start of the week working out which Geared Brushed DC motor to select. We decided that the conveyor belt needed to move a maximum of 23kg at a speed of 30cm/s. After doing calculations, I found that I needed a motor that had a power output of ~69 watts, or ~0.1 hoursepower, to accomplish the task with a friction coefficient of 1. With further calculations accounting for specific speed and torque of several motors, I decided on a motor that would probably work: MakerMotor's PN01007-10038.
            <br>
			<img src="Team/img/ConveyorMotorMath.jpg" width="650"></img>
			<br>
			<h4>Week 4:</h4>
			<b>Date:</b> 2/12/21<br>
			<b>Total hours:</b> 16<br>
			<b>Description of design efforts:</b>
			Torwards the start of the week, I was working on figuring out the power budget of our system with the motor I had originally selected. During wednesday's lab meeting, I was told that there were very powerful motors in stock that I could check out from the 477 supplies. To see if this motor would work with the kind of power I had in mind for this project, I did even more motor math this week, as seen in the image below. It turns out that the NPC-T74 will in fact work under our maximum constraints at roughly the same voltage and current as the PN01007. 
			Seperately, I did some research on potential solutions for making the support structure of the conveyor belt, and I informed the team that aluminum T-slot framing was the best option for what we needed. After consensus was reached, Jason and I did a lot of research to figure out what T-slot parts we would need to construct a good frame, and will continue to do so into next week.
			Another thing I did this week was figure out what sensor we should use to keep track of the position of the boxes on the conveyor belt. I decided on an IR laser ranging sensor that has a narrow cone of detection up to a range of 2 meters: the Taidacent TOF10120.
            <br>
			<img src="Team/img/newMotorMath.jpg" width="650"></img>
			<br>
			<h4>Week 5:</h4>
			<b>Date:</b> 2/19/21<br>
			<b>Total hours:</b> 12<br>
			<b>Description of design efforts:</b>
			This week, I focused a large majority of my efforts on defining the performance of our selected servo. Specifically, I wanted to optimize the angle needed to get the package off the belt as fast as possible, as well as determining the speed at which the sorting flaps can fully deploy. I made interactive tools through desmos so we can redefine variables as we need to in the future. Figure 5.1 goes over my theoretical work, while figures 5.2 and 5.3 demonstrate the interactive desmos graphs for frictional box acceleration and flap deployment, respectively. Here are the links to the desmos graphs: (figure 5.2) https://www.desmos.com/calculator/mrl0v81tjq ; (figure 5.3) https://www.desmos.com/calculator/yp7yjcj01m . I also continued working on the structural components of the system with Jason this week, specifically in attempting to bring our costs down. I discovered Fastenal: a local industrial supply company that sells 80/20 aluminum at a potentially lower cost compared to McMaster.
            <br>
			<img src="Team/img/servoMath.JPG" width="650"></img>
			<br>
			<h4>Week 6:</h4>
			<b>Date:</b> 2/19/21<br>
			<b>Total hours:</b> 10<br>
			<b>Description of design efforts:</b>
			This week, I spent most of my time creating our custom PCB. We decided it would be relatively easy to fabricate the custom PCB, so extra consideration is going torwards the selected components to ensure maximum solderability and price efficiency.
			Also this week, we started to consider an expanded range of options for building the physical structure of the conveyor belt due to the price of extruded aluminum being expensive. Some options we are considering include prebuilt conveyors, partially built conveyors, and even repourposing a used treadmill (arriving monday). One of the more promising options include contacting EII to see if they would be willing to assist us on our project; we will explore this option next week.
			Lastly, I recieved all of the mechatronic and power components from Jason. I will start testing the various components over the weekend to ensure functionality.
            <br>
			<img src="Team/img/schRoughDraft.png" width="650"></img>
			<h4>Week 7:</h4>
			<b>Date:</b> 3/5/21<br>
			<b>Total hours:</b> 16<br>
			<b>Description of design efforts:</b>
			This week, I spent most of my time working on our custom PCB. I have roughly finished the full PCB layout and will have it checked again next week before the Design review.
			I actually started this week by working on the hardware I recieved from Jason last week. I got a motor to spin, and that can be seen in our team's media page. I also got the PWMs from timer 1 working on the stm, as can be shown in the figure below.
            <br>
			<img src="Team/img/pwmServoFrequency.JPG" width="650"></img>
			<br>
			<b>Figure 7: PWM outputs</b>
			<br>
			<h4>Week 9:</h4>
			<b>Date:</b> 3/19/21<br>
			<b>Total hours:</b> 8<br>
			<b>Description of design efforts:</b>
			This week, I helped the team acquire and assemble a conveyor belt gifted to us by EII. I also finished designing the PCB and ordered 5 of them through JLCPCB. Since theyre coming from china, I expect to recieve them in about a week from now, maybe a little longer. Seperately, I decided to tune my 3D printer in anticipation of a possible neccessity to print various parts for the project. I am having mixed results getting it to print well, and I will continue to work on this through the weekend.
            <br>
			<img src="Team/img/finalPCB.JPG" width="650"></img>
			<br>
			<b>Figure 9: Final PCB</b>
			<br>
			<h4>Week 10:</h4>
			<b>Date:</b> 3/26/21<br>
			<b>Total hours:</b> 10<br>
			<b>Description of design efforts:</b>
			This week, I verified that the motorized rollers and the 24V 20A power supply gifted to us from EII functioned. I was able to turn on/off both conveyor rollers from my laptop which was connected to the conveyor controller (aka "Convey Linx Ai2") over ethernet.
			Afterwards, I did a little bit of research to find ways to interface the stm32 with the Ai2. So far, I found 2 options: turning the motors on/off with a single speed setting pre-programmed into the Ai2, or finding a way to use the stm to communicate over ethernet. 
			Seperately, the PCBs I ordered from JLCPCB have arrived. I also went to the ECE shop and managed to find virtually all of the components I need to assemble the PCB, with the small exceptions of the optional ferrite bead and pluggable terminal connectors. In their place, I plan on using 2 smd inducters in parallel for the ferrite bead (due to low current rating), and normal screw terminal connectors that fit perfectly on the PCB. 
			Below is a picture of the PCB with daughter boards inserted to check if they fit (which they do).
            <br>
			<img src="Team/img/PCBfit.jpg" width="650"></img>
			<br>
			<b>Figure 10: Physical PCB Fit Test</b>
			<br>
			<h4>Week 11:</h4>
			<b>Date:</b> 4/2/21<br>
			<b>Total hours:</b> 14<br>
			<b>Description of design efforts:</b>
			I started this week by soldering some of the through-hole components on my PCB (I would have started on the SMDs, but I didn't have any flux and I wanted to make progress). After I soldered the female headers onto the board, my soldering iron basically broke, so I stopped. 
			Seperately, during Wednesdays meeting, Todd expressed some concerns about how we were going about PSSC #3: The ability to interface with a motor driver. We decided that the best course of action was to try a "man-in-the-middle" atttack between the Ai2 and the rollers to figure out what kinda signals are responsible for driving the motor and to see if we can replicate them.
			In a flash of divine wisdom, I realized that I could just contact the company (Pulseroller) and ask for that information directly. After getting in contact with a sales assosciate, I learned that 3 of the 4 roller pins are directly connected to the 3 phases of the BLDC motor, with the 4th pin being some super top-secret, 1-wire, patented technology that has the hall data "and other stuff" from an chip inside the roller.
			Armed with this newfound knowledge, I went to Todd's office hours to discuss a new course of action. We agreed that the easiest thing to do would be to just use a sensorless BLDC ESC to drive the rollers. Once I learned how expensive a good sensorless ESC was, I had Jason email Joe to see if there were any ESCs we could borrow.
			Then, this morning, one of the Engineers from Pulseroller emailed me advising against using a sensorless ESC, saying that it would have a weaker starting torque. He offered to help us in figuring out how we can interface with the Ai2 from the MCU, so I sent him a brief description of what we are trying to do and a summary of our constraints. 
			I plan to explore both routes simultaneously to ensure project success, provided whatever Pulseroller's solution is realistic. My next steps depend on the pending responses from Joe and Pulseroller.
            <br>
			<img src="Team/img/PCB_headers.jpg" width="650"></img>
			<br>
			<b>Figure 11: Physical PCB with Soldered Headers</b>
			<br>
			<h4>Week 12:</h4>
			<b>Date:</b> 4/9/21<br>
			<b>Total hours:</b> 12<br>
			<b>Description of design efforts:</b>
			I started this week by ensuring that we could controll the servos using level-shifted PWMs originating from the MCU. I succeeded and recorded a video of myself demonstrating said success, which can be found onn our Media page.
			I noticed that the PWM resolution I selected only allowed for roughly 10 discrete servo positions, meaning you could only go from 0° to 180° in 18° increments, which is unideal. So, I recalculated the PSC and ARR values so that we could have more servo positions, and found
			 a set of values that give us roughly 75 discrete positions, which is much better than 10. To test this, I wrote some simple code that sweeps the servo arm between 0° and 180° continuously; this is demonstrated in Figure 12.
			 Seprately, I ordered two ESCs with sensorless functionality that we should be able to use to drive our motorized rollers. We decided to go this route due to time constraints, as pulseroller's solution has the potential to take too long to get functioning. I have already recieved the ESCs, but I had forgotten to order the 4 pin female M8 connectors needed to connect to the motor,
			  so I ordered some on amazon; they should be here on Saturday.
            <br>
			<br><center><iframe width="560" height="310" src ="Team/img/servoOscillate.mp4"></iframe></center></br>
			<br>
			<b>Figure 12: Oscillating Servo Demo</b>
			<br>	
        </div>
	
		<!-- Instantiate global footer. Any changes to the footer should be made through the top-level file "footer.html" -->
		<div id="footer"></div>
    </div>
</div>

<!--JS-->
<script src="js/jquery.js"></script>
<script src="js/jquery-migrate-1.1.1.js"></script>

<script type="text/javascript">
$(document).ready(function() {
    $("#header").load("header.html");
	$("#menu").load("navbar.html");
	$("#footer").load("footer.html");
});
</script>
</body>
</html>
